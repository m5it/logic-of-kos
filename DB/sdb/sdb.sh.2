#!/bin/bash

# Define credentials
USER="pub4all"
PASS="7gMeafZ"
SOURCE_DB="dlokkal.com_myvents"
TARGET_DB="lokkal.com_myvents"
TABLE_NAME="ads"

# Get the last ID from the source table
LAST_ID_DUMP=$(mariadb -u "$USER" -p"$PASS" "$SOURCE_DB" -Nse "SELECT MAX(id) FROM $TABLE_NAME")
echo "LAST_ID_DUMP: "$LAST_ID_DUMP

# Get the last ID from the target table
LAST_ID_LIVE=$(mariadb -u "$USER" -p"$PASS" "$TARGET_DB" -Nse "SELECT MAX(id) FROM $TABLE_NAME")
echo "LAST_ID_LIVE: "$LAST_ID_LIVE

# Ensure both IDs are valid (handle NULL cases)
LAST_ID_DUMP=${LAST_ID_DUMP:-0}
LAST_ID_LIVE=${LAST_ID_LIVE:-0}
echo "valid ids: "$LAST_ID_DUMP" - "$LAST_ID_LIVE
echo "if not null, ok!"

# Sync rows with ID > LAST_ID_DUMP
#mariadb -u "$USER" -p"$PASS" "$TARGET_DB" < <(
#  mariadb -u "$USER" -p"$PASS" "$SOURCE_DB" -Nse "
#    SELECT * FROM $TABLE_NAME WHERE id > $LAST_ID_DUMP
#  "
#)

echo "Done syncing.."
